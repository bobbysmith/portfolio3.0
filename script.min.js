const RULES_GRID=[[1,1,1],[1,1,0],[1,0,1],[1,0,0],[0,1,1],[0,1,0],[0,0,1],[0,0,0]],background=document.querySelector(".background"),row=document.querySelector(".row"),currentRule=document.querySelector(".rule--current"),newRuleButton=document.querySelector("button");let ruleNumber;function generateAutomata(){ruleNumber=Math.floor(256*Math.random())+0,background.innerHTML="",currentRule.innerHTML=`<a href="http://atlas.wolfram.com/01/01/${ruleNumber}/" target="_blank" rel="noopener noreferrer">rule ${ruleNumber}</a>`;const e=document.createElement("div");e.setAttribute("class","row"),background.appendChild(e);for(let t=1;t<background.clientWidth/8;t++)e.appendChild(document.createElement("div"));for(let t=0;t<e.childNodes.length;t++)e.childNodes[t].classList.add(Math.floor(2*Math.random())?"active":"inactive");for(let e=1;e<background.clientHeight/8;e++)duplicateRow()}function numberToBooleanArray(e){let t=Number(e).toString(2);const o=[];for(;t.length<8;)t=0+t;for(let e=0;e<t.length;e++)o.push(!!parseInt(t[e]));return o}function duplicateRow(){const e=document.querySelectorAll(".row"),t=e[e.length-1],o=t.cloneNode(!0);background.appendChild(o),processRow(o,t)}function processRow(e,t){for(let o=0;o<e.childNodes.length;o++){const n=e.childNodes[o],l=t.childNodes[o];for(let e=0;e<RULES_GRID.length;e++){const o=l.previousElementSibling||t.childNodes[t.childNodes.length-1],r=l.nextElementSibling||t.childNodes[0];setActiveIfMatchesRule.bind(null,n,o,l,r)(RULES_GRID[e],numberToBooleanArray(ruleNumber)[e])}}}function setActiveIfMatchesRule(e,t,o,n,l,r){cellState(t)===l[0]&&cellState(o)===l[1]&&cellState(n)===l[2]&&toggleActive(e,r)}function cellState(e){return e.classList.contains("active")?1:0}function toggleActive(e,t){t?(e.classList.remove("inactive"),e.classList.add("active")):(e.classList.remove("active"),e.classList.add("inactive"))}generateAutomata(),newRuleButton.addEventListener("click",generateAutomata),console.log(" _____ _____ __    __    _____\n|  |  |   __|  |  |  |  |     |\n|     |   __|  |__|  |__|  |  |\n|__|__|_____|_____|_____|_____|"),console.log("i see you like poking around in the dev console. i do too.\nlet's work together.");